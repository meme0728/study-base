<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>九九マスター</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .grid-button {
        transition: transform 0.2s ease, background-color 0.25s ease, border-color 0.25s ease;
      }
      .grid-button.selected {
        animation: pop 0.2s ease;
      }
      @keyframes pop {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.08);
        }
        100% {
          transform: scale(1);
        }
      }
    </style>
  </head>
  <body class="min-h-screen bg-amber-50 text-slate-800" style="font-family: 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'Hiragino Kaku Gothic Pro', 'Yu Gothic', 'Meiryo', sans-serif;">
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState, useMemo } = React;

      const GRID_SIZE = 9;

      const buildRange = (size) => Array.from({ length: size }, (_, index) => index + 1);

      const App = () => {
        const [selectedRow, setSelectedRow] = useState(0);
        const [selectedCol, setSelectedCol] = useState(0);
        const result = selectedRow * selectedCol;

        const gridRows = useMemo(() => buildRange(GRID_SIZE), []);

        const handleSelect = (row, col) => {
          if (row === selectedRow && col === selectedCol) {
            return;
          }
          setSelectedRow(row);
          setSelectedCol(col);
        };

        const handleReset = () => {
          setSelectedRow(0);
          setSelectedCol(0);
        };

        const isHighlighted = (row, col) => row <= selectedRow && col <= selectedCol;
        const gridLabels = useMemo(() => buildRange(GRID_SIZE), []);

        return (
          <div className="flex min-h-screen flex-col">
            <header className="bg-rose-400 py-4 text-center text-3xl font-bold text-white shadow">
              九九マスター
            </header>

            <main className="mx-auto flex w-full max-w-5xl flex-1 flex-col gap-6 px-4 py-6 lg:flex-row">
              <section className="flex-1">
                <div className="grid grid-cols-[32px_1fr] grid-rows-[auto_auto] items-stretch gap-2">
                  <div></div>
                  <div className="w-full max-w-[560px]">
                    <div className="grid grid-cols-9 gap-2">
                      {gridLabels.map((col) => (
                        <div
                          key={`col-${col}`}
                          className="flex items-center justify-center text-base font-semibold text-slate-600"
                        >
                          {col}
                        </div>
                      ))}
                    </div>
                  </div>
                  <div className="grid h-full grid-rows-9 gap-2">
                    {gridRows.map((row) => (
                      <div
                        key={`row-${row}`}
                        className="flex items-center justify-center text-base font-semibold text-slate-600"
                      >
                        {row}
                      </div>
                    ))}
                  </div>
                  <div className="aspect-square w-full max-w-[560px]">
                    <div className="grid h-full w-full grid-cols-9 grid-rows-9 gap-2">
                      {gridRows.map((row) =>
                        gridRows.map((col) => {
                          const highlighted = isHighlighted(row, col);
                          const isSelected = row === selectedRow && col === selectedCol;
                          return (
                            <button
                              key={`${row}-${col}`}
                              type="button"
                              aria-label={`${row} × ${col}`}
                              onClick={() => handleSelect(row, col)}
                              className={
                                "grid-button flex h-full w-full items-center justify-center rounded-lg border-2 focus:outline-none focus:ring-4 focus:ring-rose-200" +
                                (highlighted
                                  ? " border-rose-300 bg-rose-200"
                                  : " border-slate-200 bg-white") +
                                (isSelected ? " selected" : "")
                              }
                            />
                          );
                        })
                      )}
                    </div>
                  </div>
                </div>
              </section>

              <section className="flex w-full max-w-md flex-col gap-4">
                <div className="rounded-2xl bg-white p-6 text-center shadow">
                  <p className="text-2xl font-bold">
                    {selectedRow && selectedCol
                      ? `${selectedRow} × ${selectedCol} = ${result}`
                      : "マスをえらんでね"}
                  </p>
                </div>

                <div className="rounded-2xl bg-white p-6 shadow">
                  <p className="mb-4 text-lg font-semibold">操作エリア</p>
                  <div className="flex flex-col gap-3">
                    <button
                      type="button"
                      onClick={handleReset}
                      className="rounded-xl bg-amber-200 px-4 py-3 text-lg font-semibold text-amber-800 shadow-sm transition hover:bg-amber-300"
                    >
                      リセット
                    </button>
                  </div>
                </div>
              </section>
            </main>

            <footer className="bg-rose-100 py-4 text-center text-sm text-rose-700">
              マスをタップすると左上からの面積が色づくよ。タブレットでも使いやすいよ！
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
